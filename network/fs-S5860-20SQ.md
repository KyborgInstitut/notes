# FS S5860-20SQ: Anleitung zum ZurÃ¼cksetzen, Firmware-Upgrade und Konfiguration

Diese Anleitung basiert auf realen Erfahrungen mit einem FS S5860-20SQ Switch (Stand: Dezember 2025). Sie deckt den Factory Reset, Firmware-Upgrade (auf Version **12.6(2)B0101S4**), seriellen Zugang und Management-Zugriff ab. Der Prozess wurde auf einem M2 MacBook mit macOS durchgefÃ¼hrt.

**Wichtige Hinweise**:
- **Serieller Zugang** ist essenziell fÃ¼r Recovery (wenn WebUI nicht erreichbar).
- Nach "Format Flash" kann ein Recovery-Loop ("Can't find main kernel") auftreten â€“ lÃ¶sbar mit TFTP oder YModem.
- Backup Config vor Ã„nderungen: `copy running-config startup-config`.

## Voraussetzungen
- **Switch**: FS S5860-20SQ
- **Serielles Kabel**: RJ45-zu-USB-Adapter (FTDI/CH340-basiert)
- **Firmware**: `S5860_FSOS12.6(2)B0101S4_12201803_install.bin` (von fs.com)
- **Tools auf Mac**:
  - Terminal + `screen`
  - **CoolTerm** (grafisch, empfohlen fÃ¼r YModem-Uploads):  
    Offizielle Website: [https://freeware.the-meiers.org/](https://freeware.the-meiers.org/)  
    Direkter Download (CoolTermMac.dmg, Version 2.4.0): [https://freeware.the-meiers.org/CoolTermMac.dmg](https://freeware.the-meiers.org/CoolTermMac.dmg)
  - Built-in TFTP-Server
- **Netzwerk**: Ethernet-Kabel fÃ¼r Management-Zugriff

## Offizielle FS-Ressourcen
- **Produktseite & Downloads** (Firmware, Manuals):  
  [https://www.fs.com/products/108710.html](https://www.fs.com/products/108710.html)
- **User Manual** (inkl. CLI-Befehle, WebUI, Ports):  
  [https://img-en.fs.com/file/user_manual/s5860-20sq-user-guide.pdf](https://img-en.fs.com/file/user_manual/s5860-20sq-user-guide.pdf)
- **Software Upgrade Guide** (detaillierte Schritte fÃ¼r USB/TFTP/Modem):  
  [https://img-en.fs.com/file/user_manual/s5860-series-switches-software-upgrade-guide.pdf](https://img-en.fs.com/file/user_manual/s5860-series-switches-software-upgrade-guide.pdf)

## 1. Serieller Zugang (Console-Port)
Der RJ45-Console-Port ist fÃ¼r lokale CLI und Recovery.

### Schritte:
1. RJ45 in "CON"/"MGMT"-Port, USB in Mac.
2. Port finden:  
   ```bash
   ls /dev/cu.*
   ```
   (Beispiel: `/dev/cu.usbserial-A92UMSGA`)
3. Verbinden:
   - **screen**: `screen /dev/cu.usbserial-A92UMSGA 9600` (Default-Baud; 115200 fÃ¼r schnelleren Upload)
   - **CoolTerm**: Port wÃ¤hlen, Baud 9600/115200, 8N1, No Flow Control â†’ Connect
4. Beenden: Ctrl+A â†’ K â†’ Y

**Tipp**: Baudrate in Rboot-MenÃ¼ Ã¤ndern (Scattered utilities â†’ Set Baudrate â†’ 115200) fÃ¼r schnellere Uploads.

## 2. Factory Reset
LÃ¶scht Config und setzt Defaults (Login: admin/admin).

### Schritte:
1. Switch aus/ein â†’ Ctrl+C drÃ¼cken (Prompt "Press Ctrl+C to enter Rboot").
2. Im Rboot-MenÃ¼:
   - 4 â†’ Scattered utilities
   - 3 â†’ Format Flash â†’ Yes
3. Ctrl+Z zurÃ¼ck â†’ 2 â†’ Run main

**Erkenntnis**: Format Flash kann Firmware lÃ¶schen â†’ Recovery-Loop mÃ¶glich.

## 3. Firmware-Upgrade
Nach Reset/Loop: Neue Firmware flashen.

### Methode 1: TFTP (schnell, empfohlen â€“ 2â€“10 Min.)
1. Datei vorbereiten:
   ```bash
   sudo cp ~/Downloads/S5860_*.bin /private/tftpboot/fsos.bin
   sudo chmod 644 /private/tftpboot/fsos.bin
   sudo launchctl load -F /System/Library/LaunchDaemons/tftp.plist
   ```
2. Mac-IP: 192.168.64.10/24 (Ethernet-Kabel zu Switch-Port).
3. Im Loop: Ctrl+C â†’ Rboot â†’ 0 â†’ Tftp utilities â†’ Upgrade main â†’ Server-IP 192.168.64.10, Filename fsos.bin
4. Nach Success: Ctrl+Z â†’ 2 â†’ Run main

### Methode 2: YModem (seriell, ohne Netzwerk â€“ 2â€“5 Std. bei 115200)
1. Baudrate auf 115200 setzen (Scattered utilities).
2. Rboot â†’ 1 â†’ X/Y/ZModem â†’ 1 (YModem) â†’ 4 (Burn total FlashROM)
3. CoolTerm: Connection â†’ Send File â†’ YModem â†’ Datei â†’ Send
4. Nach 100%: Ctrl+Z â†’ 2 â†’ Run main

**Erkenntnis**: "Upgrade main program" reicht nicht immer â€“ **Burn total FlashROM** (Option 4) fÃ¼r permanentes Flashen.

**PrÃ¼fen**: `show version` â†’ **12.6(2)B0101S4**

## 4. Management-Zugang (WebUI)
Nach Boot: Default-IP oft nicht aktiv.

### IP setzen (CLI):
```
enable
configure terminal
interface vlan 1
ip address 192.168.1.200 255.255.255.0
no shutdown
exit
write memory
```

### WebUI Ã¶ffnen:
- Mac-IP: 192.168.1.100/24
- Browser: http://192.168.1.200 â†’ admin/admin
- Erstes Login: Passwort Ã¤ndern, Config Mode (Layer 2/3) wÃ¤hlen

**Layer 2 vs 3**: Layer 2 fÃ¼r reines Switching; Layer 3 fÃ¼r Inter-VLAN-Routing (kein Einfluss auf QSFP-Ports).

## 5. Passwort-Reset
1. In Rboot â†’ 4 â†’ Scattered utilities â†’ `/mnt/data` â†’ `vi config.text`
2. Zeile mit `username admin password ...` lÃ¶schen (dd)
3. `:wq` â†’ Run main
4. Neues Passwort setzen (CLI oder WebUI)

## 6. Weitere Tipps
- **Ports**: Alle (20Ã—10G, 4Ã—25G, 2Ã—40G) gleichzeitig nutzbar, non-blocking.
- **VLANs**: Default VLAN 1 â€“ fÃ¼r "dummen" Switch alles lassen.
- **Sicherheit**: Starkes Passwort, SSH aktivieren (`ip ssh server`), Management einschrÃ¤nken.
- **USB-Upgrade**: Nach normalem Boot: `upgrade usb0:<Datei>.bin`

Diese Anleitung ist fÃ¼r Ã¶ffentliche Speicherung optimiert (z. B. GitHub README). Bei Fragen: Kommentare oder Issues Ã¶ffnen! ðŸ˜Š

*Erstellt basierend auf realem Upgrade-Prozess im Dezember 2025.*
